
---
import BaseLayout from '@layouts/BaseLayout.astro';
import { getEntry } from 'astro:content';
const { slug } = Astro.params;
const entry = await getEntry('events', slug);
if (!entry) throw new Error('Evento no encontrado');
const d = entry.data;
const { Content } = await entry.render();
const eventDate = new Date(d.date);
const structured = {
  "@context": "https://schema.org",
  "@type": "Event",
  "name": d.title,
  "startDate": eventDate.toISOString(),
  "location": { "@type": "Place", "name": d.location }
};
---
<BaseLayout title={d.title + ' — Evento'} description={d.summary ?? d.location} image={d.heroImage} type="event" structuredData={structured}>
  <section class="container-tight py-10 grid gap-6 md:grid-cols-3">
    <article class="md:col-span-2 prose dark:prose-invert">
      <h1>{d.title}</h1>
      <p class="text-sm text-gray-600">
        {eventDate.toLocaleDateString('es-ES', { weekday:'long', day:'2-digit', month:'long', year:'numeric' })} • {d.location}
      </p>
      {d.summary && <p class="text-lg text-gray-700 dark:text-gray-200">{d.summary}</p>}
      <Content />
    </article>
    <aside class="space-y-4">
      {d.heroImage && <img src={d.heroImage} alt="" class="rounded-lg border border-gray-200 dark:border-gray-800" />}
      {d.brochurePdf && (
        <a
          href={d.brochurePdf}
          target="_blank"
          rel="noopener noreferrer"
          class="btn-secondary w-full justify-center normal-case"
        >
          Ver brochure (PDF)
        </a>
      )}
    </aside>
  </section>
</BaseLayout>
