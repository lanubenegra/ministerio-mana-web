
---
export const prerender = false;
import BaseLayout from '@layouts/BaseLayout.astro';
import Hero from '@components/Hero.astro';
import EventCard from '@components/EventCard.astro';
import { getCollection } from 'astro:content';
const eventsAll = (await getCollection('events')).sort((a, b) => a.data.date.localeCompare(b.data.date));
const upcoming = eventsAll.slice(0, 3);
const news = (await getCollection('news'))
  .sort((a, b) => b.data.date.localeCompare(a.data.date))
  .slice(0, 3);
---
<BaseLayout title="Ministerio Maná — Bienvenido" description="Iglesias, devocionales, Campus Maná, Escuela Bíblica y eventos.">
  <Hero title="Compartimos el Pan de Vida" subtitle="Planifica tu visita, descubre Campus Maná y participa en los próximos eventos."
    ctas={[{ href: '/iglesias/', label: 'Planifica tu visita' }, { href: '/eventos/', label: 'Ver eventos' }, { href: '/donaciones/', label: 'Donar' }]} />
  <section class="container-tight mt-12 grid gap-6 md:grid-cols-3">
    <div class="card p-5"><h3 class="font-semibold text-lg mb-1">Palabra</h3><p class="text-sm text-gray-700 dark:text-gray-200">Cristo en el centro, Escritura como fundamento. Devocional diario y discipulado.</p></div>
    <div class="card p-5"><h3 class="font-semibold text-lg mb-1">Comunidad</h3><p class="text-sm text-gray-700 dark:text-gray-200">Nos reunimos en sedes y grupos, servimos y caminamos juntos.</p></div>
    <div class="card p-5"><h3 class="font-semibold text-lg mb-1">Misión</h3><p class="text-sm text-gray-700 dark:text-gray-200">Campus Maná y obra social: jóvenes y familias que transforman su entorno.</p></div>
  </section>
  <section class="container-tight mt-12">
    <h2 class="h2 mb-3">Próximos eventos</h2>
    <div class="grid gap-6 md:grid-cols-3">
      {upcoming.map(e => <EventCard event={e} />)}
    </div>
  </section>

  <section class="container-tight py-14 space-y-6" id="noticias">
    <header class="flex flex-col gap-2 md:flex-row md:items-end md:justify-between">
      <div>
        <p class="eyebrow">Noticias y testimonios</p>
        <h2 class="h2">Lo que Dios está haciendo con Maná</h2>
        <p class="text-sm text-slate-600 max-w-xl">
          Historias reales del Devocional Maná, Mujeres que creen, Campus Maná e iglesias en las naciones.
        </p>
      </div>
      <a
        href="/noticias/"
        class="text-xs font-semibold uppercase tracking-[0.2em] text-sky-700 hover:text-sky-900"
      >
        VER TODAS
      </a>
    </header>

    <div class="grid gap-5 md:grid-cols-3">
      {news.map(({ slug, data }) => (
        <article class="rounded-3xl bg-white border border-slate-100 shadow-sm overflow-hidden flex flex-col">
          {data.image && (
            <a href={`/noticias/${slug}/`} class="block overflow-hidden aspect-[4/3]">
              <img
                src={data.image}
                alt={data.title}
                loading="lazy"
                class="w-full h-full object-cover hover:scale-105 transition-transform duration-300"
              />
            </a>
          )}
          <div class="p-5 flex flex-col gap-2 flex-1">
            <p class="text-[11px] uppercase tracking-[0.2em] text-slate-500">
              {new Date(data.date).toLocaleDateString('es-CO')}
              {data.category && <> · {data.category}</>}
            </p>
            <h3 class="text-sm font-semibold text-slate-900 line-clamp-2">
              {data.title}
            </h3>
            {data.summary && (
              <p class="text-xs text-slate-600 line-clamp-3">
                {data.summary}
              </p>
            )}
            <div class="mt-3">
              <a
                href={`/noticias/${slug}/`}
                class="inline-flex items-center gap-1 text-xs font-semibold text-sky-700 hover:text-sky-900"
              >
                Leer historia
                <span aria-hidden="true">→</span>
              </a>
            </div>
          </div>
        </article>
      ))}
    </div>
  </section>
</BaseLayout>
