---
// This component detects if user has an active session
// Shows "Iniciar sesión" for guests or account dropdown for logged users
---

<div id="account-button-container" class="relative">
  <!-- Loading state -->
  <div id="account-loading" class="w-8 h-8 rounded-full bg-neutral-100 animate-pulse"></div>
  
  <!-- Guest state: Show login button -->
  <a 
    id="account-guest" 
    href="/cuenta/ingresar" 
    class="hidden items-center gap-2 px-4 py-2 rounded-full border border-[var(--mana-border)] hover:border-brand-medium hover:bg-brand-teal/5 transition-all text-sm font-medium text-neutral-700 hover:text-brand-dark"
  >
    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
    </svg>
    <span class=" hidden sm:inline">Iniciar sesión</span>
  </a>
  
  <!-- Logged state: Show account button -->
  <details id="account-logged" class="hidden relative">
    <summary class="flex items-center gap-2 px-4 py-2 rounded-full border border-[var(--mana-border)] hover:border-brand-medium hover:bg-brand-teal/5 transition-all cursor-pointer select-none">
      <div class="w-8 h-8 rounded-full bg-brand-teal/10 flex items-center justify-center text-brand-dark font-bold text-sm">
        <span id="account-initials">U</span>
      </div>
      <span id="account-name" class="hidden sm:inline text-sm font-medium text-neutral-700"></span>
      <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-neutral-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
      </svg>
    </summary>
    
    <div class="absolute right-0 mt-3 w-56 rounded-2xl border border-[var(--mana-border-strong)] bg-[var(--mana-surface)] p-2 shadow-lg z-50">
      <a href="/cuenta/" class="flex items-center gap-3 px-4 py-3 rounded-xl hover:bg-neutral-50 text-neutral-700 hover:text-brand-dark transition-colors text-sm">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
        </svg>
        Mi Cuenta
      </a>
      <hr class="my-2 border-[var(--mana-border)]" />
      <button id="btn-logout-header" class="w-full flex items-center gap-3 px-4 py-3 rounded-xl hover:bg-red-50 text-red-600 hover:text-red-700 transition-colors text-sm">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1" />
        </svg>
        Cerrar sesión
      </button>
    </div>
  </details>
</div>

<script src="@/scripts/account-button.ts"></script>
